---
sidebar_position: 7
---

# 一个稍微复杂一点的例子

让我们看一些更复杂的东西

我们将首先尝试获取MDN的“获取”页面的内容 `curl` 命令(可用于从url请求内容): `curl https://developer.mozilla.org/en-US/docs/Web/API/fetch`

但是，这个URL是页面的旧位置

如果您在一个新的浏览器标签中输入它，您将(最终)被重定向到`https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/fetch`

因此，如果您使用curl请求 `https://developer.mozilla.org/docs/Web/API/fetch`，则不会得到输出

现在就试试：

```
curl https://developer.mozilla.org/en-US/docs/Web/API/fetch
```

我们想精确的告诉 `curl` 遵循重定向使用`-L` 标签

让我们也看看标题 `developer.mozilla.org` 返回使用 `curl` 的 `-I` 标签, 并打印它发送到终端的所有位置重定向，通过管道输出 `curl` 到`grep` (我们将要求grep返回包含单词“location”的所有行)

尝试运行以下代码，您将看到在到达最终页面之前，实际上发生了三次重定向

```
curl https://developer.mozilla.org/docs/Web/API/fetch -L -I | grep location
```

输出应该是这样的 (`curl` 首先会输出一些下载计数器之类的东西):

```
location: /en-US/docs/Web/API/fetch
location: /en-US/docs/Web/API/GlobalFetch/GlobalFetch.fetch()
location: /en-US/docs/Web/API/GlobalFetch/fetch
location: /en-US/docs/Web/API/WindowOrWorkerGlobalScope/fetch
```

尽管有些做作，我们可以把这个结果做得更深入一点，并变换 `location:` 行内容，将基本的起点添加到每个起点的开始，这样我们就可以打印出完整的url

为此，我们将在混合中添加awk(它是一种类似于JavaScript、Ruby或Python的编程语言，只是要老得多)

尝试运行这个：

```
curl https://developer.mozilla.org/docs/Web/API/fetch -L -I | grep location | awk '{ print "https://developer.mozilla.org" $2 }'
```

最终的输出应该是这样的

```
https://developer.mozilla.org/en-US/docs/Web/API/fetch
https://developer.mozilla.org/en-US/docs/Web/API/GlobalFetch/GlobalFetch.fetch()
https://developer.mozilla.org/en-US/docs/Web/API/GlobalFetch/fetch
https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/fetch
```

通过组合这些命令，我们定制了输出以显示完整的url，当我们请求时，Mozilla服务器将通过这些url重定向`/docs/Web/API/fetch` URL

了解您的系统将在未来几年证明是有用的，您将了解这些单一服务工具是如何工作的，以及它们如何成为您解决小众问题的工具库的一部分